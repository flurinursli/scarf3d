MODULE SCARFLIB

  USE, NON_INTRINSIC :: PRECISIONS

  IMPLICIT NONE

  ! --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- *


  PRIVATE

  PUBLIC :: MPI_SPLIT_TASK

  ! --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- *

  ! INTERFACE

  ! --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- *

  ! VARIABLES

  ! --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- *

  CONTAINS

    ! --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- *
    !===============================================================================================================================
    ! --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- *

    SUBROUTINE MPI_SPLIT_TASK(N, TASKS, RANK, I0, I1)

      INTEGER(ISP), INTENT(IN)  :: N
      INTEGER(ISP), INTENT(IN)  :: TASKS, RANK
      INTEGER(ISP), INTENT(OUT) :: I0, I1

      !------------------------------------------------------------------------------------------------------------------------------

      I0 = 1 + INT( REAL(N) / REAL(TASKS) * REAL(RANK) )
      I1 = INT( REAL(N) / REAL(TASKS) * REAL(RANK + 1) )

    END SUBROUTINE MPI_SPLIT_TASK

! --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- *
!===============================================================================================================================
! --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- * --- *






END MODULE SCARFLIB
